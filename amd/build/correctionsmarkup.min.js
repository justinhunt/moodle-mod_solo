define("mod_solo/correctionsmarkup",["jquery","core/log"],(function($,log){return log.debug("Corrections Markup: initialising"),{controls:{},cd:{correctionscontainer:"mod_solo_corrections_cont",insertclass:"mod_solo_finediffinsertion",wordclass:"mod_solo_grading_correctionsword",spaceclass:"mod_solo_grading_correctionsspace",suggestionclass:"mod_solo_corrections_suggestedword",wordomittedclass:"mod_solo_corrections_omittedword",aiunmatched:"mod_solo_aiunmatched"},options:{errorwords:{},grammarmatches:{},suggestedwords:{}},init:function(config){var theid="#"+config.id,configcontrol=$(theid).get(0);if(configcontrol){var opts=JSON.parse(configcontrol.value);log.debug(opts),$(theid).remove(),""!==opts.sessionerrors?this.options.suggestedwords=JSON.parse(opts.sessionerrors):this.options.suggestedwords={},""!==opts.sessionmatches?this.options.grammarmatches=JSON.parse(opts.sessionmatches):this.options.grammarmatches={}}else{if(!config.hasOwnProperty("sessionerrors")||!config.hasOwnProperty("sessionmatches"))return void log.debug("Corrections Markup js: No config found on page. Giving up.");this.options.suggestedwords=JSON.parse(config.sessionerrors),this.options.grammarmatches=JSON.parse(config.sessionmatches)}this.register_controls(),log.debug(this.options),this.markup_suggestedwords(),this.markup_unmatchedwords(),this.register_events()},register_controls:function(){this.controls.correctionscontainer=$("."+this.cd.correctionscontainer)},register_events:function(){this.controls.correctionscontainer.on("click","."+this.cd.wordclass,(function(){var wordnumber=parseInt($(this).attr("data-wordnumber"));log.debug(wordnumber)}))},markup_suggestedwords:function(){var m=this;$.each(m.options.suggestedwords,(function(index){log.debug("."+m.cd.correctionscontainer+" #"+m.cd.wordclass+"_"+m.options.suggestedwords[index].wordnumber),$("."+m.cd.correctionscontainer+" #"+m.cd.wordclass+"_"+m.options.suggestedwords[index].wordnumber).addClass(m.cd.suggestionclass)}))},markup_unmatchedwords:function(){var that=this;if(this.options.grammarmatches){var prevmatch=0;$.each(this.options.grammarmatches,(function(index,match){if(match.tposition-prevmatch>1){var missingspacenumber=match.pposition-1;missingspacenumber>0&&($("#"+that.cd.wordclass+"_"+match.pposition).hasClass(that.cd.suggestionclass)||$("#"+that.cd.wordclass+"_"+missingspacenumber).hasClass(that.cd.suggestionclass)||$("#"+that.cd.spaceclass+"_"+missingspacenumber).addClass(that.cd.wordomittedclass))}prevmatch=match.tposition}))}}}}));

//# sourceMappingURL=correctionsmarkup.min.js.map